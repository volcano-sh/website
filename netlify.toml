# ============================================================
# NETLIFY BUILD CONFIGURATION - DOCUSAURUS MIGRATION
# ============================================================
# This configuration has been updated to preview the new Docusaurus site
# during the migration from Hugo. The Docusaurus site lives in the
# volcano-docs-docusaurus/ subdirectory while we validate the migration.
#
# Once migration is complete, we'll move Docusaurus to the root and
# remove Hugo entirely.
# ============================================================

[build]
  # Point to Docusaurus subdirectory
  base = "volcano-docs-docusaurus"
  
  # Install dependencies and build Docusaurus
  command = "npm ci && npm run build"
  
  # Publish the Docusaurus build output
  publish = "build"

[build.environment]
  # Use Node.js 18 for Docusaurus compatibility
  NODE_VERSION = "18"
  # Ensure npm uses clean installs
  NPM_FLAGS = "--legacy-peer-deps"

# Production build settings
[context.production.environment]
  NODE_ENV = "production"

# Deploy preview settings (for PRs)
[context.deploy-preview]
  command = "npm ci && npm run build"

[context.deploy-preview.environment]
  NODE_VERSION = "18"

# Branch deploy settings
[context.branch-deploy]
  command = "npm ci && npm run build"

[context.branch-deploy.environment]
  NODE_VERSION = "18"

# ============================================================
# LEGACY HUGO CONFIGURATION (preserved for reference)
# ============================================================
# The following Hugo configuration is preserved but inactive.
# Remove after migration is complete.
#
# [build]
# publish = "public"
# command = "HUGO_BASEURL=$URL hugo"
#
# [context.production.environment]
# HUGO_VERSION = "0.57.2"
# HUGO_ENV = "production"
# HUGO_ENABLEGITINFO = "true"
# ============================================================
